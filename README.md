# LG-Demand_Forecasting [(Link)](https://dacon.io/competitions/official/236080/leaderboard)

## 🏆 Result
## **Public score 1st** 0.60347 | **Private score 1st** 0.58922 | 최종 1등

<img width="100%" src="https://github.com/jjuhyeok/LG-Demand_Forecasting/assets/49608953/9eab431a-5110-4d7d-9857-b60c2a2bfd0b"/>

주최 : ```LG AI Research + LG 생활건강```

규모 : 총 1400여명 참가
  

  
## 🧐 About
다양한 온라인 쇼핑몰의 일별 제품별 판매 데이터를 바탕으로   
향후 ```21일간의 제품별 판매량을 예측하는 AI 모델을 개발```하여 효율적인 재고 관리 및 타겟 마케팅 전략을 세우기 위한 대회
  
  
  
  

## 🔥**대회 느낀점**
드디어 LG 대회 우승을 위해 1년간 달려왔던 나의 노력의 결실을 맺은 대회..
이 여정에는 정말 많은 스토리가 있다..

LG Aimers 1
1년전 LG Aimers를 통해서 첫 인공지능 대회의 경험을 하였고,
처음엔 열심히 배우고 성장하자고 팀을 빌딩하여 시작하였지만,
점점 순위가 오르더니 결국 전체 리더보드 1등으로 마무리 했던 그 시간은 아직도 생생히 기억에 남습니다.
코드 검증을 통과한 후, 수상을 위해 남은 단계인 발표 평가를 준비하기 위해 몇주간의 시간이 주어졌었고
나는 팀장으로서 어떻게든 발표에서 "빈"모습을 보여주고 싶지 않아,
스스로 책도 여러권 사며 밤을 새며 발표 준비를 했었었습니다.
그렇게 발표도 마치고, 팀원들도 발표를 잘했다며 칭찬을 해주셨습니다.
또한 LG 이노텍의 심사위원분께서 칼만필터를 사용한 근거와 활용에 대해서 칭찬을 많이 해주신 부분에 대해서
그때만 생각한다면 노력의 보상을 받은 것 같아 아직도 기분이 좋습니다.
그리고 최종 수상 발표까지 하루하루를 기대하며 기다리고 있었는데,
최종 수상 발표 하루 전날 갑작스럽게 실격 통보를 받았습니다.
이동 평균을 사용하였기 때문입니다. 
사용한 이유와 그 외의 부분은 LG AI_RAIDAR 링크를 봐주시면 좋을 것 같습니다.
기대가 정말 컸던 만큼, 갑작스러운 실격에 대한 멘탈의 타격도 컸습니다.
하지만 그만큼 다음 LG 대회에는 무조건 우승을 할 것이라고 다짐 또 다짐을 하였습니다.

LG Aimers2
반년을 기다린 후 드디어 LG 대회가 시작되었습니다.
이번엔 정말 우승을 위해서, 대회 기간 전까지 다른 여러 AI 대회에 참여하며
좋은 성적 및 수상들을 하며 정말 열심히 준비했습니다.
이번 기수부터는 코로나 영향을 받지 않아서인지 온라인과 오프라인 대회 2번으로 나누어서 진행되었습니다.
온라인 대회에서 좋은 성적을 거둔 한정된 인원만 오프라인 대회에 진출하게 되는데,
온라인 대회에서 열심히 하여, 오프라인 대회에 진출하게 되었습니다.
오프라인 해커톤은 초반부터 상위권에 있다가, 기존의 방법론에서 벗어나 새로운 데이터 구조로 접근하였다.  
그 결과 public 리더보드 1등을 기록하였고, 모두가 자러간 새벽~아침7시까지 하였을 때, 2위와 차이를 점점 더 벌려 나갔었다.  

그리고 대회가 끝나기 1시간 전, 지금까지 학습했던 모델들로 voting ensemble을 하였다.  
```voting ensemble을 좀 특별하게, 최소한 한 개의 모델이 클래스 불균형이 존재하는 0과 2의 (불량)class에 대해 예측을 한다면```  
```그 sample은 불량```으로 처리를 해 주었다.  

그러자 public 점수가 정말 말도안되게 높아졌다. 2등과는 차이가 엄청 심한 압도적인 1등이었다.  
voting 후 F1 Score는 0.77428을 기록했고 2등부터 7등까지는 0.7545 ~ 0.75 8등부터 20등까지는 0.74 ~ 0.71 의 F1 score를 기록하였다.  

해커톤 대회가 종료되기 전 최종 채점받을 오직 **1개**의 csv를 제출해야 했었는데,  
이때 정말 고민을 많이 하였다.  
0.77428의 1등 score를 기록한 csv를 제출하는게 맞아 보였다.  
하지만 온라인 예선때의 기억이 스쳐 지나갔다.  
온라인 예선때도 public 3위라는 높은 등수를 가졌었고,    
1등,2등,3등 public 점수를 가진 팀들이 4등 ~ 상위권 팀들보다 압도적으로 F1 score가 높았다.    
하지만 private score 채점을 들어가자, 1등,2등,3등 팀들 모두 등수가 폭락하였다.    
overfitting이었다.  
2등분은 온라인 예선 통과조차 할 수 없었고, 1등 분은 거의 턱걸이로 오프라인 예선에 참여할 수 있었고,  
3등인 우리는 그나마 안정적으로 참여할 수 있었다.  

맞다, 이때의 기억이 떠올랐다. 현재 압도적인 1등 점수에 신뢰가 가지 않았다.  
나는 이러한 걱정을 말해주었고 팀원들은 압도적인 이 점수의 csv를 최종 제출을 해야한다, 하지말아야 한다로 분열되었고  
팀장인 나는 결정을 해야 했다.  

정말 그 짧은 몇십분의 시간동안, 정말로 별에 별 생각이 다 들었다.  
만약 내가 잘못 결정을 해서 우리 팀이 2차 평가에 진출을 하지 못하면 어떻게하지? 부터 시작해서.. 정말 힘들었다.    

나는 결정을 내렸다.  
1등이 아닌, 2등~최상위권 팀들과 비슷한 점수의 csv를 제출하기로..  
private 채점 결과 5등이 되었다.   
1등부터 5등까지 2차평가 진출 대상자여서 2차 평가에 진출을 할 수 있었다.

성능 욕심에 7시까지 혼자서 성능 조금이라도 더 올려보겠다고  
Phase 2에서 하던 아키텍처와 다른 아키텍처를 설계해서  비록 성능은 올랐지만  
다른 팀처럼 Phase2에서 사용하던 ppt 기반이 아닌, 2시간이라는 짧은 시간에 새롭게 ppt를 만들게 되어서  
완벽하지 못한 결과 ppt로 발표를 하게 되었고 결국 최종 수상은 하지 못하였다.  
압도적 1등 모델이 아닌, 점수가 더 낮은 강건한 모델을 최종 제출하자고 했던 결정이 잘못되었던 결정인지
아니면 성능 욕심에 7시까지 혼자서 성능 조금이라도 더 올려보겠다고  
Phase 2에서 하던 아키텍처와 다른 아키텍처를 설계했던 내 잘못인지
나의 결정들이 잘못된 게 아닐까 후회만 남고 믿고 따라와 준 팀원분들에게 정말 미안했다.
아직도 최종 수상자에 선정되지 못하고 집에가던 1시간동안의 버스에서의 아쉬움이 기억에 남는다.  
하지만 어쩌겠는가 후회한다고 해도 결과는 바뀌지 않고, 다음 LG 대회에선 꼭 우승해야지..

... 


---

## 📖 Dataset
```

Dataset Info.

1. 학습(Train) 데이터셋 (39607개)
ID : 실제 판매되고 있는 고유 ID
제품 : 제품 코드
대분류 : 제품의 대분류 코드
중분류 : 제품의 중분류 코드
소분류 : 제품의 소분류 코드
브랜드 : 제품의 브랜드 코드
쇼핑몰 : 쇼핑몰 코드
2022-01-01 ~ 2023-04-24 : 실제 일별 판매량
단, 제품이 동일하여도 판매되고 있는 고유 ID 별로 기재한 분류 정보가 상이할 수 있음
즉 고유 ID가 다르다면, 제품이 같더라도 다른 판매 채널

2. sales.csv - 메타(Meta) 정보
ID : 실제 판매되고 있는 고유 ID
제품 : 제품 코드
대분류 : 제품의 대분류 코드
중분류 : 제품의 중분류 코드
소분류 : 제품의 소분류 코드
브랜드 : 제품의 브랜드 코드
쇼핑몰 : 쇼핑몰 코드
2022-01-01 ~ 2023-04-24 : 실제 일별 총 판매금액
단, 제품이 동일하여도 판매되고 있는 고유 ID 별로 기재한 분류 정보가 상이할 수 있음
즉 고유 ID가 다르다면, 제품이 같더라도 다른 판매 채널


3. brand_keyword_cnt.csv - 메타(Meta) 정보
브랜드 : 브랜드 코드
2022-01-01 ~ 2023-04-24 : 브랜드의 연관키워드 언급량을 정규화한 일별 데이터


4. product_info.csv - 메타(Meta) 정보
제품 : 제품 코드
제품특성 : 제품 특성 데이터(Text)
train.csv에 존재하는 모든 제품 코드가 포함되어 있지 않음. 또는 product_info.csv에 존재하는 제품 코드가 train.csv에 존재하지 않을 수 있음


```


## 🔧 Feature Engineering
```

smoothing
- kalman filter, moving average, moving median, log
분산 / 합 / 차

```

## 🎈 Modeling

**Predict Model**
```
Autogluon
Catboost
```
